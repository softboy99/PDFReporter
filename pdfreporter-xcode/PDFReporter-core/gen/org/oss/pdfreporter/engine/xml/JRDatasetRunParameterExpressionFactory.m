//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: pdfreporter-core/src/org/oss/pdfreporter/engine/xml/JRDatasetRunParameterExpressionFactory.java
//
//  Created by kendra on 9/27/13.
//

#include "java/util/Map.h"
#include "org/oss/pdfreporter/engine/JRDataset.h"
#include "org/oss/pdfreporter/engine/JRDatasetParameter.h"
#include "org/oss/pdfreporter/engine/JRDatasetRun.h"
#include "org/oss/pdfreporter/engine/JRParameter.h"
#include "org/oss/pdfreporter/engine/design/JRDesignDataset.h"
#include "org/oss/pdfreporter/engine/design/JRDesignExpression.h"
#include "org/oss/pdfreporter/engine/design/JRValidationException.h"
#include "org/oss/pdfreporter/engine/design/JasperDesign.h"
#include "org/oss/pdfreporter/engine/xml/JRDatasetRunParameterExpressionFactory.h"
#include "org/oss/pdfreporter/engine/xml/JRXmlLoader.h"
#include "org/oss/pdfreporter/uses/org/apache/digester/IDigester.h"
#include "org/oss/pdfreporter/xml/parsers/IAttributes.h"

@implementation OrgOssPdfreporterEngineXmlJRDatasetRunParameterExpressionFactory

- (id)createObjectWithOrgOssPdfreporterXmlParsersIAttributes:(id<OrgOssPdfreporterXmlParsersIAttributes>)attributes {
  OrgOssPdfreporterEngineXmlJRXmlLoader *xmlLoader = (OrgOssPdfreporterEngineXmlJRXmlLoader *) [((id<OrgOssPdfreporterUsesOrgApacheDigesterIDigester>) nil_chk(digester_)) peekWithInt:[((id<OrgOssPdfreporterUsesOrgApacheDigesterIDigester>) nil_chk(digester_)) getCount] - 1];
  OrgOssPdfreporterEngineDesignJasperDesign *design = (OrgOssPdfreporterEngineDesignJasperDesign *) [((id<OrgOssPdfreporterUsesOrgApacheDigesterIDigester>) nil_chk(digester_)) peekWithInt:[((id<OrgOssPdfreporterUsesOrgApacheDigesterIDigester>) nil_chk(digester_)) getCount] - 2];
  id<OrgOssPdfreporterEngineJRDatasetRun> datasetRun = (id<OrgOssPdfreporterEngineJRDatasetRun>) [((id<OrgOssPdfreporterUsesOrgApacheDigesterIDigester>) nil_chk(digester_)) peekWithInt:1];
  OrgOssPdfreporterEngineDesignJRDesignDataset *dataset = (OrgOssPdfreporterEngineDesignJRDesignDataset *) [((id<JavaUtilMap>) nil_chk([((OrgOssPdfreporterEngineDesignJasperDesign *) nil_chk(design)) getDatasetMap])) getWithId:[((id<OrgOssPdfreporterEngineJRDatasetRun>) nil_chk(datasetRun)) getDatasetName]];
  if (dataset == nil) {
    [((OrgOssPdfreporterEngineXmlJRXmlLoader *) nil_chk(xmlLoader)) addErrorWithJavaLangException:[[OrgOssPdfreporterEngineDesignJRValidationException alloc] initWithNSString:[NSString stringWithFormat:@"Unknown sub dataset %@", [((id<OrgOssPdfreporterEngineJRDatasetRun>) nil_chk(datasetRun)) getDatasetName]] withId:datasetRun]];
  }
  else {
    id<OrgOssPdfreporterEngineJRDatasetParameter> runParameter = (id<OrgOssPdfreporterEngineJRDatasetParameter>) [((id<OrgOssPdfreporterUsesOrgApacheDigesterIDigester>) nil_chk(digester_)) peek];
    id<OrgOssPdfreporterEngineJRParameter> param = [((id<JavaUtilMap>) nil_chk([dataset getParametersMap])) getWithId:[((id<OrgOssPdfreporterEngineJRDatasetParameter>) nil_chk(runParameter)) getName]];
    if (param == nil) {
      [((OrgOssPdfreporterEngineXmlJRXmlLoader *) nil_chk(xmlLoader)) addErrorWithJavaLangException:[[OrgOssPdfreporterEngineDesignJRValidationException alloc] initWithNSString:[NSString stringWithFormat:@"Unknown parameter %@ in sub dataset %@", [((id<OrgOssPdfreporterEngineJRDatasetParameter>) nil_chk(runParameter)) getName], [((id<OrgOssPdfreporterEngineJRDatasetRun>) nil_chk(datasetRun)) getDatasetName]] withId:runParameter]];
    }
  }
  OrgOssPdfreporterEngineDesignJRDesignExpression *expression = [[OrgOssPdfreporterEngineDesignJRDesignExpression alloc] init];
  return expression;
}

- (id)init {
  return [super init];
}

@end
